---
title: Git工作流之功能分支工作流
s: feature_branch_workflow
date: 2021-05-15 18:15:22
tags: git
---

**Git 功能分支工作流（Feature Branch Workflow）**背后的核心思想是所有功能开发应在专用分支而不是`master`分支中进行。这种封装使多个开发人员可以轻松地使用特定功能，而又不会干扰主代码库。这也意味着`master`分支将永远不会包含残破的代码，这对于持续集成环境是一个巨大的优势。

封装功能开发还可以利用拉取请求，这是围绕分支发起讨论的一种方式。他们为其他开发人员提供了在功能集成到正式项目中之前对其进行签名的机会。或者，如果您陷于某个功能的中间，则可以开启一个**合并请求（pull request）**，以征询同事的建议。关键是，合并请求使您的团队可以非常轻松地就彼此的工作发表评论。

Git 功能分支工作流是可组合的工作流程，其他高级 Git 工作流程也可以利用。Git 功能分支工作流是针对分支模型的，这意味着它是用于管理和创建分支的指导框架。其他工作流程更注重回购。 Git Feature Branch 工作流程可以合并到其他工作流程中。实际上，**GitFlow 工作流（GitFlow Workflow）**和**Git 分叉工作流（Forking Workflow）**在其分支模型方面使用了**Git 功能分支工作流（Feature Branch Workflow）**。

## 运作原理

Git 功能分支工作流（Feature Branch Workflow）假设有一个中央仓库，而**master**则代表正式的项目历史记录，开发人员在每次开始使用新功能时都创建一个新分支，而不是直接在其本地**master**分支上提交。功能分支应具有描述性名称，例如`animated-menu-items`、`issue-#1061`或`feature_xxxx`。这个起名的目的是给每个分支一个明确的、高度集中的目的。 Git 在主分支和功能分支之间没有技术上的区别，因此开发人员可以编辑、暂存和提交对功能分支的更改。

另外，可以（并且应该）将功能分支推送到中央仓库，这样就可以与其他开发人员共享功能，而无需更改任何正式代码。由于`master`是唯一的“特殊”分支，因此在中央仓库中存储多个功能分支不会造成任何问题。当然，这也是备份每个人的本地提交的便捷方法。以下是**功能分支**的生命周期。

### 从主（master）分支开始

所有功能分支都是根据项目的最新代码状态创建的。本指南假定在 master 分支中对此进行了维护和更新。

```bash
git checkout master # 切换到 master 分支
git fetch origin  # 提取最新的提交
git reset --hard origin/master # 重置仓库的master本地副本
```

这会将仓库切换到 master 分支，提取最新的提交，并重置仓库的`master`本地副本以匹配最新版本。

### 创建新分支

为您使用的每个功能或问题使用一个单独的分支。创建分支后，请在本地将其检出，以便您所做的任何更改都将在该分支上。

```bash
git checkout -b new-feature
```

这会检出一个基于`master`的名为`new-feature`的分支，并且`-b`标志告诉 Git 创建该分支（如果尚不存在）。

### 更新

在该分支上，以正常的方式编辑、暂存和提交更改，并根据需要构建具有多次提交的功能。

```bash
git status  # 查看状态
git add <some-file> # 暂存文件
git commit  # 提交更改
```

### 将功能分支推送到远程（中央仓库）

最好将功能分支推送到中央存储库。与其他开发人员协作时，这可以用作方便的备份，这将使他们能够查看对新分支的提交。

```bash
git push -u origin new-feature
```

此命令将新功能推送到中央仓库（origin），并且`-u`标志将其添加为（上游）远程跟踪分支。设置跟踪分支后，无需任何参数即可调用`git push`来自动将新功能分支推送到中央存储库。

然后到 **git 仓库管理平台**（如 gitlab github gitee ...）去创建**合并请求**，将功能分支合并到`master`主分支。可以在提合并请求时指定审批人以确保顺利合并。（其间，如果有冲突，需要先解决冲突再提交）

## 合并请求

除了隔离功能开发之外，分支机构还可以通过合并请求讨论更改。某人完成一项功能后，不会立即将其合并到主功能中，相反，他们将功能分支推送到中央仓库，并提出合并请求，要求将其更改合并到主分支中。这使其他开发人员有机会在其更改成为主代码的一部分之前对其进行**代码审查（code review）**。

**代码审查**是合并请求的主要好处，但实际上，它们是设计用来讨论代码的通用方法。您可以将合并请求视为专门讨论特定分支的讨论地。这意味着它们也可以在开发过程中更早地被使用。例如，如果开发人员需要特定功能的帮助，则他们要做的就是提交合并请求。感兴趣的各方将被自动通知，他们将能够在相关提交旁边看到问题。

一旦合并请求被接受后，发布一个功能的实际操作与{% post_link Git工作流之集中式工作流 %}中的操作几乎相同。

> [英文原文](https://www.atlassian.com/git/tutorials/comparing-workflows/feature-branch-workflow)
