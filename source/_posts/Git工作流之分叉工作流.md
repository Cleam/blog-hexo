---
title: Git工作流之分叉工作流
date: 2021-05-18 19:39:14
tags:
---

**分叉（forking）工作流**与其他流行的 Git 工作流根本不同。它没有使用单个服务器端仓库作为“中央”代码库，而是为每个开发人员提供了自己的服务器端仓库。这意味着每个贡献者都是两个 Git 仓库：一个私有本地仓库和一个公共服务器端仓库。**分叉工作流最常见于公共开源项目中。**

分叉工作流的主要优点是可以集成贡献，而无需每个人都将其推送到单个中央仓库。开发人员将推送到他们自己的服务器端仓库，只有项目维护者才能推送到官方仓库。这使维护者可以接受任何开发人员的提交，而无需授予他们对官方代码库的写访问权限。

分叉工作流通常遵循基于《{% post_link Git工作流之GitFlow工作流 %}》的分支模型。这意味着将使用完整的功能分支来合并到原始项目维护者的仓库中。结果是一个分布式工作流，为大型组织团队（包括不受信任的第三方）提供灵活的方式来安全地进行协作。这也使其成为开源项目的理想工作流程。

## 运作原理

与其他 Git 工作流程一样，分叉工作流从存储在服务器上的官方公共仓库开始。但是，当新的开发人员希望开始从事该项目时，他们不会直接克隆官方仓库。

相反，他们`派生（fork）`了官方仓库以在服务器上创建它的副本。此新副本将用作其个人公共存储库-不允许其他开发人员将其推送到其中，但他们可以从中进行更改（我们稍后将解释为什么这很重要）。在创建服务器端副本之后，开发人员执行，`git clone`将其副本复制到本地计算机上。就像其他工作流程一样，这是他们的私有开发环境。

准备发布本地提交时，他们会将提交推送到自己的公共仓库中，而不是正式的仓库中。然后，他们向主仓库提交`合并请求（pull request）`，这使项目维护者知道已准备好要集成更新。如果所贡献的代码存在问题，则合并请求还可以用作方便的讨论线程。以下是此工作流程的分步示例。

1. 开发人员`派生（fork）`一个“官方”服务器端存储库（这将创建自己的服务器端副本）；
2. 新的服务器端副本将克隆（`git clone`）到其本地；
3. “官方”存储库的 Git 远程路径添加到本地（`git remote add origin xxx`）；
4. 创建一个新的本地`功能分支（feature branch）`；
5. 开发人员在新功能分支上进行更改；
6. 将为更改创建新的提交（`git add && git commit`）；
7. 分支被推送到开发人员自己的服务器端（副本）；
8. 开发人员打开从新分支到“官方”存储库的`合并请求（pull request）`；
9. 合并请求被批准用于合并，并被合并到原始服务器端存储库中。

为了将完成的功能集成到官方代码库中，维护人员将贡献者的更改拉入他们的本地存储库，检查以确保它不会破坏项目，将其合并到其本地 master 分支中，然后将其推送到服务器上的官方存储库中。贡献现在是项目的一部分，其他开发人员应从官方存储库中提取信息以同步其本地存储库。

重要的是要了解，Forking 工作流中“正式”存储库的概念仅仅是一个约定。实际上，使正式存储库如此正式的唯一原因是它是项目维护者的公共存储库。
