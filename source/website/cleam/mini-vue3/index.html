<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>mini vue3</title>
  <style>
    #red {
      color: red;
    }

    #green {
      color: green;
    }
  </style>
</head>

<body>
  <div id="app"></div>

  <script>
    function h(tag, props, children) {
      if (Array.isArray(props)) {
        children = props;
        props = {};
      }
      return {
        tag,
        props,
        children,
      };
    }

    function mount(vDom, container) {
      if (typeof container === 'string') {
        container = document.querySelector(container);
      }
      // tag (这里将el存储在vDom上，方便patch里面进行dom操作)
      const el = vDom.el = document.createElement(vDom.tag);
      // props/attributes
      if (vDom.props) {
        // Object.keys(vDom.props).forEach((k) => {
        //   el.setAttribute(k, vDom.props[k]);
        // });
        for (const key in vDom.props) {
          const value = vDom.props[key];
          el.setAttribute(key, value);
        }
      }
      // children
      if (vDom.children) {
        if (typeof vDom.children === 'string') {
          el.textContent = vDom.children;
        } else {
          vDom.children.forEach((child) => {
            if (typeof child === 'string') {
              el.textContent = child;
            } else {
              mount(child, el);
            }
          });
        }
      }

      container.appendChild(el);
    }

    function patch(oldVDom, newVDom) {
      const el = oldVDom.el;
      if (newVDom.tag === oldVDom.tag) {
        // props

        // children
        
      } else {
        // replace
      }
    }
  </script>

  <script>
    // const { h, mount, patch } = MiniVue3;
    // h(tagName: string[, props/attributes: object, children: array])
    // exp: h('div', {id: 'xxx', class: 'xxx'}, ['span'])
    // exp: h('div', {id: 'xxx', class: 'xxx'}, [h('span', ['Hello'])])

    // mount(vDom, container)
    // path(oldvDom, newvDom)

    const vDomDiv1 = h('div', { id: 'red' }, [h('span', ['Hello'])]);
    mount(vDomDiv1, '#app');
    // 期望渲染结果：<div id="red"><span>Hello</span></div>

    const vDomDiv2 = h('div', { id: 'green' }, [h('span', ['World'])]);
    patch(vDomDiv1, vDomDiv2);
  // 期望渲染结果：<div id="green"><span>World</span></div>
  </script>
</body>

</html>